#!/bin/bash

. /etc/systemd/system/common.sh

journalctl --rotate

cd /var/log
for f in portage/elog/summary.log emerge.log emerge-fetch.log apache2/*_log gateone/gateone*.log cvsd.log php-fpm.log letsencrypt/letsencrypt.log; do
  archive-log "$f" "$f"
done
for f in letsencrypt/letsencrypt.log.*; do
  archive-log "${f%.*}" "$f"
done
for f in tomcat-9-doctor/localhost_access_log.????-??-??.txt; do
  archive-log "${f%.*.txt}" "$f"
done
systemctl condrestart apache2 gateone postfix cvsd tomcat-9-doctor php-fpm@7.0

cd /var/log/journal
for host in ????????????????????????????????; do
  cd "$host"
  for f in *@????????????????????????????????-?????????????????????????????????.journal *@????????????????-????????????????.journal'~'; do
    archive-journal "$host" "$f"
  done
done
